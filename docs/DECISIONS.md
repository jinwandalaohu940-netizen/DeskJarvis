# 技术决策记录 (ADR - Architecture Decision Records)

> **重要**：所有重要的技术决策都应记录在此，确保AI辅助开发时保持一致性。

## 格式说明

每个决策记录包含：
- **日期**：决策日期
- **状态**：Proposed / Accepted / Deprecated / Superseded
- **上下文**：为什么需要这个决策
- **决策**：选择了什么方案
- **后果**：这个决策的影响

---

## ADR-001: 选择Tauri作为桌面框架

**日期**：2025-01-XX  
**状态**：Accepted  
**决策者**：项目团队

### 上下文
需要跨平台桌面应用框架，在Electron和Tauri之间选择。

### 决策
选择Tauri，原因：
- 更小的体积和内存占用
- 更好的安全性（Rust后端）
- 性能更好
- 符合"轻量级"定位

### 后果
- ✅ 需要学习Rust基础（但Tauri封装良好，学习成本可控）
- ✅ 打包体积小，用户体验好
- ⚠️ Rust生态相对较小，但Tauri社区活跃

---

## ADR-002: Python Agent通过Shell Command调用

**日期**：2025-01-XX  
**状态**：Accepted  
**决策者**：项目团队

### 上下文
Tauri（Rust）需要调用Python Agent，有多种通信方式：
1. Shell Command（子进程）
2. HTTP服务（Python作为服务）
3. WebSocket实时通信

### 决策
MVP阶段使用Shell Command，原因：
- 实现简单，快速验证
- 不需要额外的服务管理
- 适合MVP阶段

**未来扩展**：如果后续需要实时通信，可以升级为HTTP/WebSocket。

### 后果
- ✅ 开发速度快
- ✅ 架构简单
- ⚠️ 实时性较差（但MVP阶段可接受）
- ⚠️ 错误处理需要完善（进程通信）

---

## ADR-003: 使用Playwright而非Selenium

**日期**：2025-01-XX  
**状态**：Accepted  
**决策者**：项目团队

### 上下文
需要浏览器自动化工具，在Selenium和Playwright之间选择。

### 决策
选择Playwright，原因：
- 更现代，API更友好
- 支持多浏览器（Chromium、Firefox、WebKit）
- 自动等待机制更好
- 社区活跃，文档完善

### 后果
- ✅ 开发体验好
- ✅ 稳定性高
- ⚠️ 需要安装浏览器二进制文件（但可以自动下载）

---

## ADR-004: 使用Claude API作为主要AI模型

**日期**：2025-01-XX  
**状态**：Accepted  
**决策者**：项目团队

### 上下文
需要选择AI模型API，在Claude、GPT-4、本地模型之间选择。

### 决策
主要使用Claude API（Anthropic），原因：
- 工具调用能力强
- 视觉理解能力强（适合网页分析）
- 安全性好（Anthropic注重安全）
- 备选：支持OpenAI GPT-4（用户可选择）

**未来扩展**：支持本地模型（Ollama）作为备选。

### 后果
- ✅ 功能强大
- ⚠️ 需要API费用（用户自付）
- ⚠️ 依赖外部服务（但可接受）

---

## ADR-005: 文件操作限制在沙盒目录

**日期**：2025-01-XX  
**状态**：Accepted  
**决策者**：项目团队

### 上下文
需要平衡安全性和易用性，文件操作的范围限制。

### 决策
默认限制在用户指定的沙盒目录，原因：
- 安全性：避免误操作系统文件
- 可控性：用户明确知道操作范围
- 可配置：高级用户可以扩展权限

**危险操作**（删除、系统命令）需要用户确认。

### 后果
- ✅ 安全性高
- ⚠️ 可能需要用户配置沙盒路径（但首次启动可引导）

---

## ADR-006: 使用LangGraph/CrewAI构建Agent

**日期**：2025-01-XX  
**状态**：Proposed（待验证）  
**决策者**：项目团队

### 上下文
需要构建AI Agent的工作流，有多种框架选择。

### 决策
计划使用LangGraph或CrewAI，原因：
- 提供Agent工作流框架
- 支持工具调用
- 社区活跃

**待验证**：MVP阶段先手动实现简单版本，验证后再引入框架。

### 后果
- ⚠️ 需要学习框架（但文档完善）
- ✅ 代码更结构化
- ⚠️ 可能增加复杂度（需要评估）

---

## ADR-007: 日志使用JSON格式

**日期**：2025-01-XX  
**状态**：Accepted  
**决策者**：项目团队

### 上下文
需要记录操作日志，选择日志格式。

### 决策
使用JSON格式存储日志，原因：
- 结构化数据，便于分析
- 可以轻松导入到日志分析工具
- 支持后续的日志查询和分析功能

### 后果
- ✅ 便于后续分析
- ⚠️ 文件可读性稍差（但可以用工具查看）

---

## ADR-008: 使用MIT许可证（待确认）

**日期**：2025-01-XX  
**状态**：Proposed  
**决策者**：项目团队

### 上下文
当前使用GPLv3，考虑是否改为MIT。

### 决策
**待确认**：考虑改为MIT许可证，原因：
- 更友好，商业项目更容易采用
- 社区贡献更容易
- 但需要确认是否符合项目目标

**当前状态**：保持GPLv3，后续根据社区反馈决定。

### 后果
- ⚠️ 需要确认是否符合项目定位
- ✅ MIT更友好（如果改为MIT）

---

## 如何添加新决策

当遇到技术选择时：
1. 创建新的ADR条目
2. 记录上下文、决策、后果
3. 更新状态（Proposed → Accepted）
4. 如果决策被推翻，标记为Deprecated或Superseded

---

**最后更新**：2025-01-XX  
**维护者**：项目团队
